<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Focus Productivity Extension</title>
    <link rel="stylesheet" href="popup.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header Section -->
      <header class="header">
        <h1 class="title">Focus Productivity</h1>
        <button class="settings-btn" id="settingsBtn" aria-label="Settings">
          ‚öôÔ∏è
        </button>
      </header>

      <!-- Screen Time Monitoring Section -->
      <section class="section screen-time-section">
        <div class="section-header">
          <h2 class="section-title">Screen Time</h2>
          <span class="current-time" id="currentTime">0m</span>
        </div>
        <div class="section-content">
          <div class="time-limit-control">
            <label for="timeLimitInput">Break reminder after:</label>
            <div class="input-group">
              <input
                type="number"
                id="timeLimitInput"
                min="5"
                max="180"
                value="30"
                title="Set break reminder time (5-180 minutes)"
              />
              <span>minutes</span>
            </div>
          </div>
          <div class="screen-time-controls">
            <button class="btn btn-secondary" id="takeBreakBtn" title="Reset current session timer">
              Take Break Now
            </button>
            <button class="btn btn-small" id="resetScreenTimeBtn" title="Clear all screen time data">
              Reset Data
            </button>
          </div>
        </div>
      </section>

      <!-- Focus Tracking Section -->
      <section class="section focus-section">
        <div class="section-header">
          <h2 class="section-title">Focus Tracking</h2>
          <div class="focus-status-indicator" id="focusStatusIndicator">
            <span class="status-dot" id="focusStatusDot"></span>
            <span class="status-text" id="focusStatusText">Not Active</span>
          </div>
        </div>
        <div class="section-content">
          <div class="focus-tab-display">
            <span class="focus-label">Focus Tab:</span>
            <span class="focus-url" id="focusUrl">Not set</span>
          </div>
          
          <div class="focus-session-info" id="focusSessionInfo" style="display: none;">
            <div class="session-stat">
              <span class="stat-label">Session Time:</span>
              <span class="stat-value" id="focusSessionTime">0m</span>
            </div>
            <div class="session-stat">
              <span class="stat-label">Deviations:</span>
              <span class="stat-value" id="focusDeviationCount">0</span>
            </div>
            <div class="session-stat">
              <span class="stat-label">Last Reminder:</span>
              <span class="stat-value" id="lastFocusReminder">Never</span>
            </div>
          </div>

          <div class="focus-controls">
            <button class="btn btn-secondary" id="setFocusBtn">
              Set Current Tab as Focus
            </button>
            <button class="btn btn-small" id="resetFocusBtn">Reset</button>
          </div>

          <div class="focus-deviation-history" id="focusDeviationHistory" style="display: none;">
            <h4 class="history-title">Recent Deviations</h4>
            <div class="deviation-list" id="deviationList">
              <!-- Deviation items will be populated here -->
            </div>
            <button class="btn btn-small btn-text" id="toggleHistoryBtn">
              Show History
            </button>
          </div>
        </div>
      </section>

      <!-- Task Management Section -->
      <section class="section task-section">
        <div class="section-header">
          <h2 class="section-title">AI Task Breakdown</h2>
        </div>
        <div class="section-content">
          <div class="task-input-group">
            <input
              type="text"
              id="taskNameInput"
              placeholder="Enter task name"
              class="task-input"
            />
            <input
              type="datetime-local"
              id="taskDeadlineInput"
              class="task-input"
            />
          </div>
          <button class="btn btn-primary" id="getBreakdownBtn">
            Get AI Breakdown
          </button>
          <div class="task-breakdown" id="taskBreakdown" style="display: none">
            <h3>Task Breakdown:</h3>
            <ul id="breakdownList"></ul>
          </div>
        </div>
      </section>

      <!-- Calendar Integration Section -->
      <section class="section calendar-section">
        <div class="section-header">
          <h2 class="section-title">Calendar Reminders</h2>
        </div>
        <div class="section-content">
          <div class="calendar-input-group">
            <select id="prioritySelect" class="priority-select">
              <option value="high">High Priority</option>
              <option value="medium" selected>Medium Priority</option>
              <option value="low">Low Priority</option>
            </select>
            <button class="btn btn-primary" id="createRemindersBtn">
              Create Reminders
            </button>
          </div>
          <div class="calendar-status" id="calendarStatus"></div>
        </div>
      </section>

      <!-- Wellness Tools Section -->
      <section class="section wellness-section">
        <div class="section-header">
          <h2 class="section-title">Wellness Tools</h2>
        </div>
        <div class="section-content">
          <div class="wellness-controls">
            <div class="breathing-control">
              <button class="btn btn-wellness" id="breathingBtn">
                <span class="icon">ü´Å</span>
                <span>Breathing Exercise</span>
              </button>
            </div>
            <div class="audio-control">
              <button class="btn btn-wellness toggle-btn" id="whiteNoiseBtn">
                <span class="icon">üîä</span>
                <span>White Noise</span>
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- External Pages Section -->
      <section class="section external-pages-section">
        <div class="section-header">
          <h2 class="section-title">Additional Tools</h2>
        </div>
        <div class="section-content">
          <div class="external-buttons">
            <button class="btn btn-external" id="focusAnxietyBtn">
              <span class="icon">üßò</span>
              <span>Focus & Anxiety Management</span>
            </button>
            <button class="btn btn-external" id="asmrFidgetBtn">
              <span class="icon">üéµ</span>
              <span>ASMR & Fidgeting Tools</span>
            </button>
          </div>
        </div>
      </section>

      <!-- Breathing Exercise Modal -->
      <div class="modal" id="breathingModal" style="display: none">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Breathing Exercise</h3>
            <button class="close-btn" id="closeBreathingBtn">&times;</button>
          </div>
          <div class="breathing-container">
            <div class="breathing-circle" id="breathingCircle"></div>
            <div class="breathing-text" id="breathingText">
              Click Start to begin
            </div>
            <div class="breathing-controls">
              <button class="btn btn-primary" id="startBreathingBtn">
                Start
              </button>
              <button
                class="btn btn-secondary"
                id="stopBreathingBtn"
                style="display: none"
              >
                Stop
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="../services/storage-manager.js"></script>
    <script src="../services/gemini-service.js"></script>
    <script src="../utils/constants.js"></script>
    <script src="components/task-manager.js"></script>
    <script src="popup.js"></script>
  </body>
</html>
